@model _24DH112073_MyStore.Models.ViewModel.ProductDetailsVM

@{
    ViewBag.Title = Model.Product.ProductName;
    Layout = "~/Views/Shared/_CustomerLayout.cshtml";
}

<style>
    .pro-section {
        padding: 15px;
        background-color: #fff;
        border-radius: 5px;
    }

    .pro-price {
        color: #d70018;
        font-size: 24px;
        font-weight: bold;
    }

    .pro-sale {
        color: #666;
        font-size: 14px;
    }

    .input-qty {
        max-width: 100px;
        display: inline-block;
        margin-right: 10px;
    }
</style>

<div class="container-fluid pro" style="margin-top: 20px;">
    <div class="row">
        @* ======= KHỐI BÊN TRÁI (Ảnh sản phẩm) ======= *@
        <div class="col-md-4 pro-section">
            @* Dùng Url.Content để xử lý đường dẫn ảnh có dấu ~ *@
            <img src="@Url.Content(Model.Product.ProductImage)" style="width: 100%; height: auto; object-fit: contain;" alt="@Model.Product.ProductName" />
        </div>

        @* ======= KHỐI Ở GIỮA (Thông tin sản phẩm) ======= *@
        <div class="col-md-5 pro-section">
            <h3>@Model.Product.ProductName</h3>

            @* SỬA ĐOẠN HIỂN THỊ GIÁ *@
            <p class="pro-price" style="color: red; font-size: 20px; font-weight: bold;">
                @Model.Product.ProductPrice.ToString("#,##0", System.Globalization.CultureInfo.GetCultureInfo("en-US")).Replace(',', '.') ₫
            </p>

            <p class="pro-sale">
                Đã bán: @(Model.Product.OrderDetails != null ? Model.Product.OrderDetails.Count : 0)
            </p>

            <p><strong>Danh mục:</strong> @Model.Product.Category.CategoryName</p>

            <hr />
            <h5><strong>Mô tả sản phẩm:</strong></h5>
            <p>
                @* Hiển thị mô tả, nếu null thì hiện thông báo *@
                @(Model.Product.ProductDecription ?? "Đang cập nhật...")
            </p>
        </div>

        @* ======= KHỐI BÊN PHẢI (Chọn mua) ======= *@
        <div class="col-md-3 pro-section" style="border-left: 1px solid #eee;">

            @* Dùng Form để gửi đúng Số lượng người dùng nhập tới CartController *@
            @using (Html.BeginForm("AddToCart", "Cart", FormMethod.Post))
            {
                <h4>Đặt mua</h4>

                <div class="form-group">
                    <label>Số lượng:</label>
                    @* Ô nhập số lượng *@
                    @Html.TextBox("quantity", Model.Quantity, new { @class = "form-control input-qty", @type = "number", @min = "1" })

                    @* Truyền ID sản phẩm (ẩn) *@
                    @Html.Hidden("id", Model.Product.ProductID)
                </div>

                <div class="form-group" style="margin-top: 15px;">
                    <button type="submit" class="btn btn-danger btn-lg btn-block">
                        <i class="fa fa-shopping-cart"></i> Thêm vào giỏ hàng
                    </button>
                </div>
            }

            <hr />
            @* Khối sản phẩm bán chạy *@
            @Html.Partial("_PVTopProduct", Model)
        </div>
    </div>

    <hr />

    @* ======= SẢN PHẨM TƯƠNG TỰ ======= *@
    <div class="row">
        <div class="col-md-12">
            @Html.Partial("_PVRelatedProduct", Model)
        </div>
    </div>
</div>